#      .
#     / V\
#   / `  /
#  <<   |    Default values for mautrix-bluesky Helm chart.
#  /    |    You should look at the values examples for what to actually apply.
#

nameOverride: ""
fullnameOverride: ""

image:
  repository: dock.mau.dev/mautrix/bluesky
  tag: "v0.2510.0"
  pullPolicy: IfNotPresent

service:
  port: 29317
  publishNotReadyAddresses: true

podSecurityContext:
  enabled: true
  seccompProfile:
    type: RuntimeDefault

securityContext:
  enabled: true
  allowPrivilegeEscalation: false
  readOnlyRootFilesystem: false
  capabilities:
    drop:
      - ALL

homeserver:
  address: http://ess-synapse.ess.svc.cluster.local:8008
  # Required: Matrix domain used by homeserver config and registration regex entries.
  domain: ""

appservice:
  id: bluesky
  botUsername: blueskybot
  # Optional override. Defaults to in-cluster service URL.
  address: ""
  hostname: 0.0.0.0
  port: 29317
  ephemeralEvents: true
  provisioning:
    # Optional override. If empty, sourced from registration.existingSecret when set; otherwise auto-generated when registration.autoGenerate=true.
    sharedSecret: ""

registration:
  # If empty, sourced from registration.existingSecret when set; otherwise auto-generated when registration.autoGenerate=true.
  asToken: ""
  hsToken: ""
  # Existing Secret containing keys `asToken`, `hsToken`, and `provisioningSharedSecret`.
  # When set, no chart-managed runtime Secret is created.
  existingSecret: ""
  managedSecret:
    # Create a chart-managed runtime Secret when existingSecret is not set.
    enabled: true
    # Optional override for the managed Secret name.
    name: ""
  # Auto-generate missing runtime secrets only when using a chart-managed Secret.
  autoGenerate: true
  # Optional override. Defaults to appservice.address value.
  serviceUrl: ""
  # Optional overrides. If empty, derived from bridge username/alias templates.
  userRegex: ""
  aliasRegex: ""
  # Optional override. Defaults to appservice.botUsername.
  senderLocalpart: ""
  rateLimited: false
  # Optional namespace for an additional Synapse registration ConfigMap copy.
  # A cross-namespace copy is created only when this is non-empty and different from the release namespace.
  synapseNamespace: ""
  # Leave empty to derive from release name, e.g. "<release>-mautrix-bluesky-registration".
  synapseConfigMapName: ""

bridge:
  usernameTemplate: bluesky_{userid}
  aliasTemplate: bluesky_{groupname}
  resources: {}

config:
  # Raw bridge config YAML merged into generated config.yaml.
  # If this overlaps with Helm-managed keys, template rendering fails.
  extra: ""

database:
  name: mautrix_bluesky
  user: mautrix_bluesky
  password: mautrix_bluesky_password
  # Optional override. Required when postgres.enabled is false.
  connectionString: ""

postgres:
  enabled: true
  image:
    repository: postgres
    tag: "16-alpine"
    pullPolicy: IfNotPresent
  service:
    port: 5432
  persistence:
    enabled: true
    accessMode: ReadWriteOnce
    size: 10Gi
    storageClassName: ""
  podSecurityContext:
    enabled: true
    seccompProfile:
      type: RuntimeDefault
  securityContext:
    enabled: true
    allowPrivilegeEscalation: false
    readOnlyRootFilesystem: false
  resources: {}

probes:
  liveness:
    enabled: false
    path: /_matrix/mau/live
    initialDelaySeconds: 20
    periodSeconds: 30
    timeoutSeconds: 5
    failureThreshold: 3
  readiness:
    enabled: false
    path: /_matrix/mau/ready
    initialDelaySeconds: 10
    periodSeconds: 15
    timeoutSeconds: 5
    failureThreshold: 3
